This query was created in https://sqliteonline.com/ tool, where I created the tables mentioned in the question.

Author: Euler Bakke